# 시스템 아키텍처

## 전체 시스템 구조

```
┌─────────────────────────────────────────────────────────────────┐
│                         사용자 (Browser)                          │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             │ HTTPS
                             │
┌────────────────────────────▼────────────────────────────────────┐
│                      Frontend (React)                            │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │  React 18 + Vite                                         │  │
│  │  - React Router (라우팅)                                  │  │
│  │  - Zustand (상태 관리)                                    │  │
│  │  - TailwindCSS (스타일링)                                │  │
│  │  - Axios (HTTP 클라이언트)                               │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  주요 페이지:                                                    │
│  - Home, Login, Signup                                          │
│  - Courses, CourseDetail                                        │
│  - Dashboard, MyClassroom                                       │
│  - Applications, ApplicationForm                                │
│  - Notices, FAQ, Inquiry                                        │
│  - Profile                                                      │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             │ REST API (JSON)
                             │ JWT Authentication
                             │
┌────────────────────────────▼────────────────────────────────────┐
│                    Backend (Spring Boot)                         │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │  Spring Boot 3.2.0                                       │  │
│  │  - Spring Security (인증/인가)                            │  │
│  │  - Spring Data JPA (ORM)                                 │  │
│  │  - Spring Web (REST API)                                 │  │
│  │  - JWT Token Provider                                    │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  계층 구조:                                                      │
│  ┌─────────────┐                                                │
│  │ Controller  │ ← REST API 엔드포인트                          │
│  └──────┬──────┘                                                │
│         │                                                        │
│  ┌──────▼──────┐                                                │
│  │  Service    │ ← 비즈니스 로직                                │
│  └──────┬──────┘                                                │
│         │                                                        │
│  ┌──────▼──────┐                                                │
│  │ Repository  │ ← 데이터 접근                                  │
│  └──────┬──────┘                                                │
│         │                                                        │
│  ┌──────▼──────┐                                                │
│  │   Entity    │ ← JPA 엔티티                                   │
│  └─────────────┘                                                │
└────────────────────────────┬────────────────────────────────────┘
                             │
                             │ JDBC
                             │
┌────────────────────────────▼────────────────────────────────────┐
│                    Database (MySQL/H2)                           │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │  개발: H2 (In-Memory)                                    │  │
│  │  운영: MySQL 8.0                                         │  │
│  └──────────────────────────────────────────────────────────┘  │
│                                                                  │
│  주요 테이블:                                                    │
│  - users (사용자)                                               │
│  - courses (교육과정)                                           │
│  - lectures (강의)                                              │
│  - enrollments (수강)                                           │
│  - applications (지원신청)                                      │
│  - assignments (과제)                                           │
│  - submissions (제출)                                           │
│  - projects (프로젝트)                                          │
│  - notices (공지사항)                                           │
│  - faqs (FAQ)                                                   │
│  - inquiries (문의)                                             │
└─────────────────────────────────────────────────────────────────┘
```

---

## 인증 흐름 (Authentication Flow)

```
┌─────────┐                                    ┌─────────┐
│ Client  │                                    │ Server  │
└────┬────┘                                    └────┬────┘
     │                                              │
     │  1. POST /auth/login                         │
     │  { username, password }                      │
     ├─────────────────────────────────────────────>│
     │                                              │
     │                                              │ 2. 사용자 확인
     │                                              │    비밀번호 검증
     │                                              │
     │  3. JWT Token 발급                           │
     │  { accessToken, refreshToken }               │
     │<─────────────────────────────────────────────┤
     │                                              │
     │  4. Token 저장 (LocalStorage)                │
     │                                              │
     │                                              │
     │  5. API 요청 (with Token)                    │
     │  Authorization: Bearer {token}               │
     ├─────────────────────────────────────────────>│
     │                                              │
     │                                              │ 6. Token 검증
     │                                              │    권한 확인
     │                                              │
     │  7. 응답                                     │
     │<─────────────────────────────────────────────┤
     │                                              │
     │                                              │
     │  8. Token 만료 시                            │
     │  POST /auth/refresh                          │
     │  { refreshToken }                            │
     ├─────────────────────────────────────────────>│
     │                                              │
     │  9. 새 Token 발급                            │
     │<─────────────────────────────────────────────┤
     │                                              │
```

---

## 데이터 흐름 (Data Flow)

### 예시: 교육과정 지원 신청

```
┌─────────┐     ┌──────────┐     ┌─────────┐     ┌──────────┐
│ Browser │     │ Frontend │     │ Backend │     │ Database │
└────┬────┘     └────┬─────┘     └────┬────┘     └────┬─────┘
     │               │                │               │
     │ 1. 지원 버튼 클릭                │               │
     ├──────────────>│                │               │
     │               │                │               │
     │               │ 2. 폼 검증     │               │
     │               │                │               │
     │               │ 3. POST /applications          │
     │               │    + JWT Token │               │
     │               ├───────────────>│               │
     │               │                │               │
     │               │                │ 4. Token 검증 │
     │               │                │               │
     │               │                │ 5. 데이터 검증│
     │               │                │               │
     │               │                │ 6. INSERT     │
     │               │                ├──────────────>│
     │               │                │               │
     │               │                │ 7. 저장 완료  │
     │               │                │<──────────────┤
     │               │                │               │
     │               │ 8. 응답 (201)  │               │
     │               │<───────────────┤               │
     │               │                │               │
     │ 9. 성공 메시지 표시              │               │
     │<──────────────┤                │               │
     │               │                │               │
```

---

## 보안 계층 (Security Layers)

```
┌─────────────────────────────────────────────────────────┐
│                     Application                          │
│  ┌───────────────────────────────────────────────────┐  │
│  │  1. HTTPS/TLS (전송 계층 암호화)                  │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  2. CORS (Cross-Origin 제어)                      │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  3. JWT Authentication (인증)                     │  │
│  │     - Access Token (24시간)                       │  │
│  │     - Refresh Token (7일)                         │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  4. Role-based Authorization (인가)               │  │
│  │     - ROLE_USER                                   │  │
│  │     - ROLE_INSTRUCTOR                             │  │
│  │     - ROLE_ADMIN                                  │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  5. Input Validation (입력 검증)                  │  │
│  │     - React Hook Form                             │  │
│  │     - Spring Validation                           │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  6. SQL Injection Prevention                      │  │
│  │     - JPA Prepared Statements                     │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  7. XSS Prevention                                │  │
│  │     - React의 자동 이스케이핑                      │  │
│  └───────────────────────────────────────────────────┘  │
│  ┌───────────────────────────────────────────────────┐  │
│  │  8. Password Encryption                           │  │
│  │     - BCrypt                                      │  │
│  └───────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

---

## 데이터베이스 ERD (Entity Relationship Diagram)

```
┌──────────────┐
│    User      │
│──────────────│
│ id (PK)      │
│ username     │
│ email        │
│ password     │
│ name         │
│ phone        │
│ roles        │
└──────┬───────┘
       │
       │ 1:N
       │
       ├─────────────────┐
       │                 │
       │                 │
┌──────▼───────┐  ┌──────▼───────┐
│ Application  │  │ Enrollment   │
│──────────────│  │──────────────│
│ id (PK)      │  │ id (PK)      │
│ user_id (FK) │  │ user_id (FK) │
│ course_id    │  │ course_id    │
│ status       │  │ progress     │
│ motivation   │  │ status       │
└──────────────┘  └──────────────┘
       │
       │ N:1
       │
┌──────▼───────┐
│   Course     │
│──────────────│
│ id (PK)      │
│ title        │
│ description  │
│ category     │
│ level        │
│ duration     │
│ capacity     │
└──────┬───────┘
       │
       │ 1:N
       │
       ├─────────────────┬─────────────────┐
       │                 │                 │
┌──────▼───────┐  ┌──────▼───────┐  ┌──────▼───────┐
│   Lecture    │  │  Assignment  │  │   Project    │
│──────────────│  │──────────────│  │──────────────│
│ id (PK)      │  │ id (PK)      │  │ id (PK)      │
│ course_id    │  │ course_id    │  │ course_id    │
│ title        │  │ title        │  │ title        │
│ videoUrl     │  │ dueDate      │  │ teamName     │
└──────────────┘  └──────┬───────┘  └──────────────┘
                         │
                         │ 1:N
                         │
                  ┌──────▼───────┐
                  │  Submission  │
                  │──────────────│
                  │ id (PK)      │
                  │ assignment_id│
                  │ user_id (FK) │
                  │ content      │
                  │ score        │
                  └──────────────┘

┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│   Notice     │  │     FAQ      │  │   Inquiry    │
│──────────────│  │──────────────│  │──────────────│
│ id (PK)      │  │ id (PK)      │  │ id (PK)      │
│ title        │  │ question     │  │ user_id (FK) │
│ content      │  │ answer       │  │ title        │
│ category     │  │ category     │  │ content      │
│ isPinned     │  │ orderIndex   │  │ status       │
└──────────────┘  └──────────────┘  └──────────────┘
```

---

## 배포 아키텍처 (Deployment Architecture)

### 개발 환경
```
┌─────────────────────────────────────┐
│       Developer Machine             │
│                                     │
│  ┌──────────┐    ┌──────────┐     │
│  │ Frontend │    │ Backend  │     │
│  │ :3000    │    │ :8080    │     │
│  └──────────┘    └────┬─────┘     │
│                       │            │
│                  ┌────▼─────┐     │
│                  │ H2 (mem) │     │
│                  └──────────┘     │
└─────────────────────────────────────┘
```

### 프로덕션 환경
```
┌─────────────────────────────────────────────────────────┐
│                    Load Balancer                         │
└────────────────────┬────────────────────────────────────┘
                     │
        ┌────────────┴────────────┐
        │                         │
┌───────▼────────┐       ┌────────▼───────┐
│  Nginx Server  │       │  Nginx Server  │
│  (Frontend)    │       │  (Frontend)    │
└───────┬────────┘       └────────┬───────┘
        │                         │
        │ Reverse Proxy           │
        │                         │
┌───────▼────────┐       ┌────────▼───────┐
│ Spring Boot    │       │ Spring Boot    │
│ (Backend)      │       │ (Backend)      │
└───────┬────────┘       └────────┬───────┘
        │                         │
        └────────────┬────────────┘
                     │
              ┌──────▼──────┐
              │    MySQL    │
              │  (Primary)  │
              └──────┬──────┘
                     │
              ┌──────▼──────┐
              │    MySQL    │
              │  (Replica)  │
              └─────────────┘
```

---

## 기술 스택 상세

### Frontend Stack
```
React 18
├── React Router v6 (라우팅)
├── Zustand (상태 관리)
│   └── persist (영구 저장)
├── React Hook Form (폼 관리)
├── Axios (HTTP 클라이언트)
│   └── Interceptors (인증, 에러 처리)
├── TailwindCSS (스타일링)
└── Lucide React (아이콘)
```

### Backend Stack
```
Spring Boot 3.2.0
├── Spring Security (보안)
│   ├── JWT
│   ├── BCrypt
│   └── CORS
├── Spring Data JPA (ORM)
│   └── Hibernate
├── Spring Web (REST API)
├── Spring Validation (검증)
└── Spring Mail (이메일)
```

### Database Stack
```
Development: H2 (In-Memory)
Production: MySQL 8.0
├── InnoDB Engine
├── UTF8MB4 Character Set
└── Connection Pool (HikariCP)
```

---

## 성능 최적화 전략

### Frontend
1. **Code Splitting** - 라우트별 분리
2. **Lazy Loading** - 컴포넌트 지연 로딩
3. **Memoization** - React.memo, useMemo
4. **Image Optimization** - WebP, 압축

### Backend
1. **Connection Pool** - HikariCP
2. **Query Optimization** - N+1 문제 해결
3. **Caching** - Spring Cache (향후)
4. **Pagination** - 대용량 데이터 처리

### Database
1. **Indexing** - 자주 조회되는 컬럼
2. **Query Optimization** - Explain Plan
3. **Replication** - Read/Write 분리 (향후)

---

## 모니터링 및 로깅

```
┌─────────────────────────────────────────┐
│          Application Logs                │
│  - Spring Boot Logging                  │
│  - Console + File                       │
└────────────────┬────────────────────────┘
                 │
┌────────────────▼────────────────────────┐
│         Health Check                     │
│  - Spring Actuator                      │
│  - /actuator/health                     │
└────────────────┬────────────────────────┘
                 │
┌────────────────▼────────────────────────┐
│         Metrics (향후)                   │
│  - Prometheus                           │
│  - Grafana                              │
└─────────────────────────────────────────┘
```

---

이 아키텍처는 확장 가능하고 유지보수가 용이하도록 설계되었습니다.
